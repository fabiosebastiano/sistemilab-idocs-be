
CREATE TABLE UTENTE(
  ID BIGSERIAL PRIMARY KEY,
  USERNAME VARCHAR(16) NOT NULL UNIQUE,
  MAIL VARCHAR(30) NOT NULL UNIQUE,
  NOME VARCHAR(16) NOT NULL,
  COGNOME VARCHAR(16) NOT NULL,
  PASSWORD VARCHAR(16) NOT NULL --DA TRASFORMARE IN CAMPO PASSWORD
);

--CREATE TYPE NAZIONE_CLIENTE AS ENUM ('italia', 'francia', 'germania');
--CREATE TYPE FORMATO_DOCUMENTO AS ENUM ('pdf', 'doc', 'xls');

CREATE TABLE CLIENTE(
  ID BIGSERIAL PRIMARY KEY,
  RAGIONE_SOCIALE VARCHAR(64) NOT NULL UNIQUE,
  PARTITA_IVA VARCHAR(64) NOT NULL UNIQUE,
  NAZIONE VARCHAR(64) NOT NULL,
  DESCRIZIONE TEXT
);

CREATE TABLE PROGETTO(
  ID BIGSERIAL PRIMARY KEY,
  NOME TEXT NOT NULL,
  DESCRIZIONE TEXT
);


CREATE TABLE DOCUMENTO(
  ID BIGSERIAL PRIMARY KEY,
  NOME text NOT NULL,
  DESCRIZIONE text,
  ESTENSIONE VARCHAR(16) NOT NULL,
  DIMENSIONE INT NOT NULL,
  STATO VARCHAR(16) NOT NULL DEFAULT 'DA APPROVARE',
  DATA_CAMBIO_STATO DATE,
  DATA_CARICAMENTO DATE NOT NULL
);

CREATE TABLE UTENTE_CLIENTE(
  ID_UTENTE BIGSERIAL REFERENCES UTENTE (ID) ON UPDATE CASCADE ON DELETE CASCADE,
  ID_CLIENTE BIGSERIAL REFERENCES CLIENTE (ID) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE CLIENTE_PROGETTO(
  ID_CLIENTE BIGSERIAL REFERENCES CLIENTE (ID) ON UPDATE CASCADE ON DELETE CASCADE,
  ID_PROGETTO BIGSERIAL REFERENCES PROGETTO (ID) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE PROGETTO_DOCUMENTO(
  ID_PROGETTO BIGSERIAL REFERENCES PROGETTO (ID) ON UPDATE CASCADE ON DELETE CASCADE,
  ID_DOCUMENTO BIGSERIAL REFERENCES DOCUMENTO (ID) ON UPDATE CASCADE ON DELETE CASCADE
);
